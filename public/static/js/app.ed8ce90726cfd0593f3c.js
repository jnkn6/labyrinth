webpackJsonp([1],{"//fM":function(e,n){},0:function(e,n){},"7zck":function(e,n){},"9Ez/":function(e,n){},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("7+uW"),i=t("3EgV"),a=t.n(i),d=(t("7zck"),t("csSS"),t("sphj"),t("69U5")),s=t("ZEWO"),r=t("gyJL"),l=t("1bcK"),m={render:function(){var e=this.$createElement,n=this._self._c||e;return n("v-app",[n("router-view")],1)},staticRenderFns:[]},c=t("VU/8")({name:"App"},m,!1,null,null,null).exports,u=t("/ocq"),p={render:function(){var e=this.$createElement;return(this._self._c||e)("div",[this._v("Main Page")])},staticRenderFns:[]},f=t("VU/8")({name:"MainPage"},p,!1,null,null,null).exports,h=t("Dd8w"),v=t.n(h),g=t("NYxO"),_={name:"Header",methods:v()({},Object(g.b)(["setDraggingTag"]),{onDrag:function(e){this.setDraggingTag(e.target.id)}})},E={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-app-bar",{attrs:{color:"#01012b",dense:"",dark:""}},[t("v-app-bar-nav-icon"),e._v(" "),t("v-toolbar-title",[e._v("Flow graph")]),e._v(" "),t("v-spacer"),e._v(" "),t("v-menu",{scopedSlots:e._u([{key:"activator",fn:function(n){var o=n.on,i=n.attrs;return[t("v-btn",e._g(e._b({attrs:{icon:""}},"v-btn",i,!1),o),[t("v-icon",[e._v("mdi-plus")])],1)]}}])},[e._v(" "),t("v-list",[t("v-subheader",[e._v("Add node")]),e._v(" "),t("v-list-item",[t("v-chip",{attrs:{draggable:"",color:"#ff2a6d",id:"domain"},on:{drag:e.onDrag}},[e._v("\n                    Domain\n                ")])],1),e._v(" "),t("v-list-item",[t("v-chip",{attrs:{draggable:"",color:"#d1f7ff",id:"page"},on:{drag:e.onDrag}},[e._v("\n                    Page\n                ")])],1)],1)],1)],1)},staticRenderFns:[]},N=t("VU/8")(_,E,!1,null,null,null).exports,M="CREATE_PAGE",P="EDIT_DOMAIN",y="EDIT_PAGE",I="READ_DOMAIN_INFO",D="READ_PAGE_INFO",b={DOMAIN:[I,P],PAGE:[M,y,D],EDIT:[y,P],CREATE:[M]},w=t("NM3X"),C=t.n(w),$=(t("hGhl"),t("eKt1")),O=t.n($),S=t("iZbT"),k=t.n(S),x=(t("//fM"),t("V4YW")),T=t.n(x),A=(t("irot"),t("2R8v")),G=t.n(A),F=t("tlQw"),R=t.n(F),U=G()(["\n    query allImages($id: ID!) {\n        allImages(id: $id) {\n            source\n        }\n    }\n"],["\n    query allImages($id: ID!) {\n        allImages(id: $id) {\n            source\n        }\n    }\n"]),q=R()(U),V={name:"InfoCardSlot",components:{FilePond:C()(O.a,k.a,T.a)},props:{isEditing:{type:Boolean},node:{type:Object}},data:function(){return{images:[]}},methods:{fileRenameFunction:function(e){var n=window.prompt("Enter new filename");return this.node.data._id+"_"+n+e.extension},handleFilePondInit:function(){var e=this,n=[];this.$apollo.query({query:q,variables:{id:this.node.data._id}}).then(function(t){t.data.allImages.forEach(function(e){n.push({source:e.source,options:{type:"limbo"}})}),e.images=n})}}},j={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-card",{attrs:{elevation:"10"}},[t("v-card-actions",[t("v-spacer"),e._v(" "),t("v-btn",{attrs:{icon:"",outlined:""},on:{click:function(n){return e.$emit("onClose")}}},[t("v-icon",[e._v("mdi-close")])],1)],1),e._v(" "),t("v-card-title",[e._t("title")],2),e._v(" "),t("v-card-text",[e.isEditing?e._t("editInfo"):e._t("readInfo"),e._v(" "),e.isEditing?t("file-pond",{ref:"pond",attrs:{name:"filepond","label-idle":"Drop files here...","allow-multiple":!0,"accepted-file-types":"image/png",server:{url:"http://127.0.0.1:3000",process:"/upload/img",revert:"/upload/img",restore:"/upload/",load:"/upload/"},files:e.images,fileRenameFunction:e.fileRenameFunction,copyRelativePath:!0,alertCopyPath:!0},on:{init:e.handleFilePondInit}}):e._e()],2),e._v(" "),t("v-card-actions",[t("v-spacer"),e._v(" "),e.isEditing?t("div",[t("v-btn",{attrs:{elevation:"1",rounded:""},on:{click:function(n){return e.$emit("onCancel")}}},[t("v-icon",[e._v("\n                    mdi-cancel\n                ")]),e._v("\n                Cancel\n            ")],1),e._v(" "),t("v-btn",{attrs:{elevation:"3",color:"#99ff00",rounded:""},on:{click:function(n){return e.$emit("onSave")}}},[t("v-icon",[e._v("\n                    mdi-checkbox-marked-circle\n                ")]),e._v("\n                Save\n            ")],1)],1):t("v-btn",{attrs:{elevation:"3",rounded:""},on:{click:function(n){return e.$emit("onEdit")}}},[t("v-icon",[e._v("\n                mdi-pencil\n            ")]),e._v("\n            Edit\n        ")],1)],1)],1)},staticRenderFns:[]},B=t("VU/8")(V,j,!1,null,null,null).exports,H=t("EFqf"),Y=t.n(H),L=t("OvQW"),z=t.n(L),X=t("6nXs"),W=t.n(X),K=(t("p5PA"),t("V8mf")),Q=t.n(K),J={name:"Editor",props:{value:String},data:function(){return{config:{},easymde:null}},methods:{bindingEvents:function(){var e=this;this.easymde.codemirror.on("change",function(n,t){if("setValue"!==t.origin){var o=e.easymde.value();e.handleInput(o)}}),this.easymde.codemirror.on("blur",function(){var n=e.easymde.value();e.handleBlur(n)})},handleInput:function(e){this.isUpdated=!0,this.$emit("input",e)},handleBlur:function(e){this.isUpdated=!0,this.$emit("blur",e)}},mounted:function(){this.config={element:this.$el.firstElementChild,renderingConfig:{singleLineBreaks:!1,codeSyntaxHighlighting:!0,hljs:Q.a,sanitizerFunction:function(e){return z.a.sanitize(e,{USE_PROFILES:{html:!0}})}},initialValue:this.value,showIcons:["table"]},this.easymde=new W.a(this.config),this.bindingEvents()}},Z={render:function(){this.$createElement;this._self._c;return this._m(0)},staticRenderFns:[function(){var e=this.$createElement,n=this._self._c||e;return n("div",{staticClass:"easymde"},[n("textarea")])}]},ee=t("VU/8")(J,Z,!1,null,null,null).exports,ne={name:"DomainInfoCard",props:{mode:{type:String},node:{type:Object}},components:{InfoCardSlot:B,Editor:ee},watch:{mode:{handler:function(e,n){this.workMode=e}},node:{handler:function(e,n){this.url=e.data.url,this.memo=e.data.memo}}},data:function(){return{url:this.node.data.url,memo:null===this.node.data.memo?"":this.node.data.memo,workMode:this.mode,memoModified:null===this.node.data.memo?"":this.node.data.memo}},computed:{title:function(){switch(this.workMode){case I:return"Domain infomation";case P:return"Edit domain information"}},isEditing:function(){return b.EDIT.includes(this.workMode)},compiledMemo:function(){var e=Y()(this.memo);return z.a.sanitize(e,{USE_PROFILES:{html:!0}})}},methods:v()({},Object(g.b)(["modifyDomainNode"]),{onClose:function(){this.$emit("onClose")},onEdit:function(){this.workMode=P},onSave:function(){var e=this;this.memo=this.memoModified;var n=v()({},this.node.data,{memo:this.memo});this.modifyDomainNode({vue:this,oldNode:this.node,newDomainData:n}).then(function(){e.workMode=I})},onCancel:function(){this.memoModified=this.memo,this.workMode=I},onMemoInput:function(e){this.memoModified=e},onMemoBlur:function(e){this.memoModified=e}})},te={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("info-card-slot",{attrs:{isEditing:e.isEditing,node:e.node},on:{onClose:e.onClose,onSave:e.onSave,onEdit:e.onEdit,onCancel:e.onCancel}},[t("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.title))]),e._v(" "),t("div",{attrs:{slot:"readInfo"},slot:"readInfo"},[t("p",[e._v("url: "+e._s(e.url))]),e._v(" "),t("p",[e._v("memo: "+e._s(e.memo))]),e._v(" "),t("v-card",[t("v-card-title",[e._v("Memo")]),e._v(" "),t("v-card-text",{domProps:{innerHTML:e._s(e.compiledMemo)}})],1)],1),e._v(" "),t("div",{attrs:{slot:"editInfo"},slot:"editInfo"},[t("v-row",[t("v-col",[t("v-text-field",{attrs:{label:"Domain URL",disabled:""},model:{value:e.url,callback:function(n){e.url=n},expression:"url"}}),e._v(" "),t("v-card",[t("v-card-title",[e._v("Memo")]),e._v(" "),t("v-card-text",[t("editor",{attrs:{value:e.memoModified},on:{input:e.onMemoInput,blur:e.onMemoBlur}})],1)],1)],1)],1)],1)])},staticRenderFns:[]},oe=t("VU/8")(ne,te,!1,null,null,null).exports,ie={name:"PageInfoCard",props:{mode:{type:String},node:{type:Object}},watch:{mode:{handler:function(e,n){this.workMode=e}},node:{handler:function(e,n){this.name=e.data.name,this.path=e.data.path,this.memo=null===e.data.memo?"":e.data.memo,this.nameModified=e.data.name,this.pathModified=e.data.path,this.memoModified=null===e.data.memo?"":e.data.memo,this.mode!==this.workMode&&(this.workMode=this.mode)}}},components:{InfoCardSlot:B,Editor:ee},data:function(){return{name:this.node.data.name,path:this.node.data.path,memo:null===this.node.data.memo?"":this.node.data.memo,workMode:this.mode,nameModified:this.node.data.name,pathModified:this.node.data.path,memoModified:null===this.node.data.memo?"":this.node.data.memo}},computed:{title:function(){switch(this.workMode){case y:return"Edit page information";case D:return"Page informtaion"}},isEditing:function(){return b.EDIT.includes(this.workMode)},compiledMemo:function(){var e=Y()(this.memo);return z.a.sanitize(e,{USE_PROFILES:{html:!0}})}},methods:v()({},Object(g.b)(["modifyPageNode"]),{onClose:function(){this.$emit("onClose")},onEdit:function(){this.workMode=y},onSave:function(){var e=this;this.name=this.nameModified,this.path=this.pathModified,this.memo=this.memoModified;var n=v()({},this.node.data,{name:this.name,path:this.path,memo:this.memo});this.modifyPageNode({vue:this,oldNode:this.node,newPageData:n}).then(function(){e.workMode=D})},onCancel:function(){this.nameModified=this.name,this.pathModified=this.path,this.memoModified=this.memo,this.workMode=D},onMemoInput:function(e){this.memoModified=e},onMemoBlur:function(e){this.memoModified=e}}),beforeDestroy:function(){},beforeUpdate:function(){}},ae={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("info-card-slot",{attrs:{isEditing:e.isEditing,node:e.node},on:{onClose:e.onClose,onSave:e.onSave,onEdit:e.onEdit,onCancel:e.onCancel}},[t("div",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.title))]),e._v(" "),t("div",{attrs:{slot:"readInfo"},slot:"readInfo"},[t("p",[e._v("name: "+e._s(e.name))]),e._v(" "),t("p",[e._v("path: "+e._s(e.path))]),e._v(" "),t("v-card",[t("v-card-title",[e._v("Memo")]),e._v(" "),t("v-card-text",{domProps:{innerHTML:e._s(e.compiledMemo)}})],1)],1),e._v(" "),t("div",{attrs:{slot:"editInfo"},slot:"editInfo"},[t("v-row",[t("v-col",[t("v-text-field",{attrs:{label:"Page name"},model:{value:e.nameModified,callback:function(n){e.nameModified=n},expression:"nameModified"}}),e._v(" "),t("v-text-field",{attrs:{label:"Page path"},model:{value:e.pathModified,callback:function(n){e.pathModified=n},expression:"pathModified"}}),e._v(" "),t("v-card",[t("v-card-title",[e._v("Memo")]),e._v(" "),t("v-card-text",[t("editor",{attrs:{value:e.memoModified},on:{input:e.onMemoInput,blur:e.onMemoBlur}})],1)],1)],1)],1)],1)])},staticRenderFns:[]},de={name:"InfoCard",components:{DomainInfoCard:oe,PageInfoCard:t("VU/8")(ie,ae,!1,null,null,null).exports},props:{mode:{type:String},node:{type:Object}}},se={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",["domain"===e.node.type?t("domain-info-card",{attrs:{mode:e.mode,node:e.node},on:{onClose:function(n){return e.$emit("onClose")}}}):e._e(),e._v(" "),"page"===e.node.type?t("page-info-card",{attrs:{mode:e.mode,node:e.node},on:{onClose:function(n){return e.$emit("onClose")}}}):e._e()],1)},staticRenderFns:[]},re=t("VU/8")(de,se,!1,null,null,null).exports,le=t("GiK3"),me=t.n(le),ce=t("g432");t("9Ez/");function ue(e){var n=e.data;return me.a.createElement("div",{className:"node domainNode"},me.a.createElement("div",{className:"titleBox"},me.a.createElement("i",{className:"mdi mdi-earth"}),"Domain"),me.a.createElement("div",{className:"infoBox"},me.a.createElement("div",null,me.a.createElement("b",null,"URL "),n.url)),me.a.createElement(ce.b,{type:"source",position:"right"}))}function pe(e){var n=e.data;return me.a.createElement("div",{className:"node pageNode"},me.a.createElement(ce.b,{type:"target",position:"left"}),me.a.createElement("div",{className:"titleBox"},me.a.createElement("i",{className:"mdi mdi-file"}),"Page"),me.a.createElement("div",{className:"infoBox"},me.a.createElement("div",null,me.a.createElement("b",null,"Path "),n.path,me.a.createElement("br",null),me.a.createElement("b",null,"Name "),n.name)),me.a.createElement(ce.b,{type:"source",position:"right"}))}var fe={name:"NodeMenu",props:{selectedMenuNode:{type:Object}},data:function(){return{isPageOpened:!1}},methods:v()({},Object(g.b)(["fetchPageNodes","emptyPageNodes","emptyEdges"]),{onClickOpenPages:function(){var e=this;if(this.isPageOpened)return this.emptyPageNodes(),this.emptyEdges(),void(this.isPageOpened=!1);this.fetchPageNodes({vue:this,domainNode:this.selectedMenuNode}).then(function(){e.isPageOpened=!0})}})},he={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",["domain"===e.selectedMenuNode.type?t("v-list",[t("v-subheader",[e._v("Domain Menu")]),e._v(" "),t("v-list-item",{on:{click:e.onClickOpenPages}},[t("v-list-item-avatar",[t("v-icon",[e._v("mdi-file")])],1),e._v(" "),e.isPageOpened?t("v-list-item-content",[e._v("\r\n                Close pages\r\n            ")]):t("v-list-item-content",[e._v("\r\n                Open pages\r\n            ")])],1)],1):"page"===e.selectedMenuNode.type?t("v-list",[t("v-subheader",[e._v("Page Menu")]),e._v(" "),t("v-list-item",[t("v-list-item-title",[e._v("\r\n                Open components\r\n                ")])],1)],1):e._e()],1)},staticRenderFns:[]},ve=t("VU/8")(fe,he,!1,null,null,null).exports,ge={name:"FlowGraph",props:{domain:{type:String}},components:{ReactFlowGraph:function(e){var n={domain:ue,page:pe},t={width:"100%",height:(.6*window.innerHeight).toString()+"px"};return me.a.createElement(ce.d,{nodeTypes:n,style:t,elements:e.elements,onElementClick:e.onElementClick,onDrop:e.onDrop,onDragOver:function(e){e.preventDefault()},onNodeContextMenu:e.onNodeContextMenu},me.a.createElement(ce.c,null),me.a.createElement(ce.a,null))},InfoCard:re,NodeMenu:ve},computed:v()({},Object(g.c)(["graphElements"]),Object(g.d)(["domainNode","pageNodes","edges","draggingTag"])),data:function(){return{showInfo:!1,mode:null,selectedNode:null,showNodeMenu:!1,nodeMenuX:0,nodeMenuY:0,selectedMenuNode:null}},methods:v()({},Object(g.b)(["fetchDomainNode","createNode"]),{onDrop:function(e){var n=this;this.createNode({vue:this,type:this.draggingTag,position:{x:e.clientX,y:e.clientY-48}}).then(function(e){switch(n.draggingTag){case"page":n.mode=y}n.selectedNode=e,n.showInfo=!0})},onNodeContextMenu:function(e,n){e.preventDefault(),this.nodeMenuX=e.clientX,this.nodeMenuY=e.clientY,this.selectedMenuNode=n,this.showNodeMenu=!0},onElementClick:function(e,n){if(this.showInfo&&n.id===this.selectedNode.id)return this.mode=null,this.selectedNode=null,void(this.showInfo=!1);switch(n.type){case"domain":this.onDomainClick(e,n);break;case"page":this.onPageClick(e,n)}},onPageClick:function(e,n){this.mode=D,this.selectedNode=n,this.showInfo=!0},onDomainClick:function(e,n){this.mode=I,this.selectedNode=n,this.showInfo=!0},onCloseInfo:function(){this.showInfo=!1,this.mode=null,this.selectedNode=null}}),created:function(){this.fetchDomainNode({vue:this,domain:this.domain})}},_e={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-container",{attrs:{fluid:""}},[t("div",[t("react-flow-graph",{attrs:{elements:e.graphElements,onElementClick:e.onElementClick,onDrop:e.onDrop,onNodeContextMenu:e.onNodeContextMenu}}),e._v(" "),t("v-menu",{attrs:{"position-x":e.nodeMenuX,"position-y":e.nodeMenuY,absolute:""},model:{value:e.showNodeMenu,callback:function(n){e.showNodeMenu=n},expression:"showNodeMenu"}},[t("node-menu",{attrs:{selectedMenuNode:e.selectedMenuNode}})],1),e._v(" "),e.showInfo?t("info-card",{attrs:{mode:e.mode,node:e.selectedNode},on:{onClose:e.onCloseInfo}}):e._e()],1)])},staticRenderFns:[]},Ee=t("VU/8")(ge,_e,!1,null,null,null).exports,Ne={name:"GraphPage",props:{domain:{type:String}},components:{AppHeader:N,FlowGraph:Ee}},Me={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",[n("app-header"),this._v(" "),n("flow-graph",{attrs:{domain:this.domain}})],1)},staticRenderFns:[]},Pe=t("VU/8")(Ne,Me,!1,null,null,null).exports;o.default.use(u.a);var ye,Ie=new u.a({mode:"history",routes:[{path:"/",name:"MainPage",component:f},{path:"/graph/:domain",name:"GraphPage",components:{default:Pe},props:{default:!0}}]}),De=t("bOdI"),be=t.n(De),we=(ye={},be()(ye,"SET_DOMAIN_NODE",function(e,n){e.domainNode=n}),be()(ye,"EMPTY_PAGE_NODES",function(e){e.pageNodes=[]}),be()(ye,"EMPTY_EDGES",function(e){e.edges=[]}),be()(ye,"CONCAT_PAGE_NODES",function(e,n){e.pageNodes=e.pageNodes.concat(n)}),be()(ye,"CONCAT_EDGES",function(e,n){e.edges=e.edges.concat(n)}),be()(ye,"DELETE_PAGE_NODE",function(e,n){for(var t=0;t<e.pageNodes.length;t++)if(e.pageNodes[t].id===n){e.pageNodes.splice(t,1);break}for(var o=0;o<e.edges.length;o++)e.edges[o].target===n?e.edges.splice(o,1):e.edges[o].source===n&&e.edges.splice(o,1)}),be()(ye,"PUSH_PAGE_NODE",function(e,n){e.pageNodes.push(n)}),be()(ye,"PUSH_EDGE",function(e,n){e.edges.push(n)}),be()(ye,"SET_DRAGGING_TAG",function(e,n){e.draggingTag=n}),be()(ye,"UPDATE_PAGE_NODE",function(e,n){for(var t=0;t<e.pageNodes.length;t++)if(e.pageNodes[t].id===n.id){e.pageNodes.splice(t,1),e.pageNodes.push(n);break}}),ye),Ce=G()(["\n    query domainInfo($url: String!) {\n        domainInfo(url: $url) {\n            _id\n            url\n            pages\n            memo\n        }\n}"],["\n    query domainInfo($url: String!) {\n        domainInfo(url: $url) {\n            _id\n            url\n            pages\n            memo\n        }\n}"]),$e=G()(["\n    mutation modifyDomain ($domain: DomainInput!) {\n        modifyDomain (domain: $domain) {\n            _id\n            url\n            pages\n            memo\n        }\n    }\n"],["\n    mutation modifyDomain ($domain: DomainInput!) {\n        modifyDomain (domain: $domain) {\n            _id\n            url\n            pages\n            memo\n        }\n    }\n"]),Oe=R()(Ce),Se=R()($e),ke=G()(["\n    query pageInfo ($_id: ID!) {\n        pageInfo (_id: $_id) {\n            _id\n            url\n            memo\n        }\n    }\n"],["\n    query pageInfo ($_id: ID!) {\n        pageInfo (_id: $_id) {\n            _id\n            url\n            memo\n        }\n    }\n"]),xe=G()(["\n    query allPagesInfo ($domain: ID!) {\n        allPagesInfo(domain: $domain) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"],["\n    query allPagesInfo ($domain: ID!) {\n        allPagesInfo(domain: $domain) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"]),Te=G()(["\n    query pagesInfo ($ids: [ID!]!) {\n        pagesInfo(ids: $ids) {\n\n            _id\n            name\n\n        }\n    }\n\n"],["\n    query pagesInfo ($ids: [ID!]!) {\n        pagesInfo(ids: $ids) {\n\n            _id\n            name\n\n        }\n    }\n\n"]),Ae=G()(["\n    mutation createPage ($page: PageInput!) {\n        createPage (page: $page) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"],["\n    mutation createPage ($page: PageInput!) {\n        createPage (page: $page) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"]),Ge=G()(["\n    mutation modifyPage ($page: PageInput!) {\n        modifyPage (page: $page) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"],["\n    mutation modifyPage ($page: PageInput!) {\n        modifyPage (page: $page) {\n            _id\n            name\n            path\n            domain\n            groups\n            components\n            memo\n        }\n    }\n"]),Fe=(R()(ke),R()(xe)),Re=(R()(Te),R()(Ae)),Ue=R()(Ge),qe={fetchDomainNode:function(e,n){var t=e.commit,o=n.vue,i=n.domain;o.$apollo.query({query:Oe,variables:{url:i}}).then(function(e){t("SET_DOMAIN_NODE",{id:e.data.domainInfo._id,type:"domain",data:v()({},e.data.domainInfo),position:{x:100,y:100}})})},fetchPageNodes:function(e,n){var t=e.commit,o=n.vue,i=n.domainNode,a=[],d=[];o.$apollo.query({query:Fe,variables:{domain:i.data._id}}).then(function(e){var n=i.position.x+200,s=i.position.y;e.data.allPagesInfo.forEach(function(e,t){a.push({id:e._id,type:"page",data:v()({},e),position:{x:n,y:s}}),s+=130,d.push({id:"e"+i.data._id+"-"+e._id,source:i.data._id,target:e._id,type:"step"})}),t("CONCAT_PAGE_NODES",a),o.$nextTick(function(){t("CONCAT_EDGES",d)})}).catch(function(e){console.log(e)})},emptyPageNodes:function(e){(0,e.commit)("EMPTY_PAGE_NODES")},emptyEdges:function(e){(0,e.commit)("EMPTY_EDGES")},concatPageNodes:function(e,n){(0,e.commit)("CONCAT_PAGE_NODES",n)},concatEdges:function(e,n){(0,e.commit)("CONCAT_EDGES",n)},createNode:function(e,n){var t=e.dispatch,o=n.vue,i=n.type,a=n.position;switch(i){case"page":return t("createPageNode",{vue:o,position:a});case"domain":return void console.log("createNode domain is not implemented")}},createPageNode:function(e,n){var t=e.state,o=e.commit,i=n.vue,a=n.position;return i.$apollo.mutate({mutation:Re,variables:{page:{_id:"new_id",name:"new_page",path:"new_path",domain:t.domainNode.data._id,groups:[],components:[],memo:""}}}).then(function(e){var n={id:e.data.createPage._id,type:"page",position:a,data:e.data.createPage};return o("PUSH_PAGE_NODE",n),i.$nextTick(function(){o("PUSH_EDGE",{id:"e"+t.domainNode.data._id+"-"+n.id,source:t.domainNode.data._id,target:n.id,type:"step"})}),n})},modifyDomainNode:function(e,n){var t=e.commit,o=n.vue,i=n.oldNode,a=n.newDomainData;o.$apollo.mutate({mutation:Se,variables:{domain:a}}).then(function(e){var n=v()({},i,{data:e.data.modifyDomain});t("SET_DOMAIN_NODE",n)})},modifyPageNode:function(e,n){var t=e.commit,o=n.vue,i=n.oldNode,a=n.newPageData;o.$apollo.mutate({mutation:Ue,variables:{page:a}}).then(function(e){var n=v()({},i,{data:e.data.modifyPage});t("UPDATE_PAGE_NODE",n)})},setDraggingTag:function(e,n){(0,e.commit)("SET_DRAGGING_TAG",n)}};o.default.use(g.a);var Ve=new g.a.Store({state:{domainNode:null,pageNodes:[],edges:[],draggingTag:""},getters:{graphElements:function(e){var n=[];return null!==e.domainNode&&n.push(e.domainNode),n=n.concat(e.pageNodes),n=n.concat(e.edges),n}},mutations:we,actions:qe}),je=t("hm+w");t.d(n,"apolloClient",function(){return He}),o.default.use(je.VuePlugin),o.default.use(a.a),o.default.config.productionTip=!1;o.default.use(d.a);var Be=new r.a({uri:"//localhost:3000/graphql"}),He=new s.a({link:Be,cache:new l.a({addTypename:!1}),connectToDevTools:!0,defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}}}),Ye=new d.a({defaultClient:He});new o.default({el:"#app",vuetify:new a.a({}),apolloProvider:Ye,router:Ie,store:Ve,components:{App:c},template:"<App/>"})},csSS:function(e,n){},hGhl:function(e,n){},irot:function(e,n){},p5PA:function(e,n){},sphj:function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.ed8ce90726cfd0593f3c.js.map